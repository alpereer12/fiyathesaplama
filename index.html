<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    
    <!-- BU SATIR GOOGLE'IN SİTEYİ BULMASINI ENGELLER -->
    <meta name="robots" content="noindex, nofollow">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Ofset Kutu Maliyet Paneli (Tam Sürüm v30 - Kesim Fix)</title>
    
    <!-- Kütüphaneler -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        darkbg: '#0f172a',
                        darkcard: '#1e293b',
                        darkinput: '#334155'
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body { transition: background-color 0.3s ease; -webkit-tap-highlight-color: transparent; }
        .modal-enter { opacity: 0; transform: scale(0.95); }
        .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity 300ms, transform 300ms; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
        
        #loading-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #f8fafc; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 9999; 
            transition: opacity 0.5s ease;
        }
        html.dark #loading-screen { background: #0f172a; color: #e2e8f0; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.3s ease-in-out; }
    </style>
</head>
<body class="bg-slate-100 dark:bg-darkbg text-slate-800 dark:text-slate-100 font-sans pb-10 transition-colors duration-300">

    <div id="loading-screen">
        <div class="text-2xl font-bold text-blue-600 mb-2 animate-bounce">Hesaplama Aracı Yükleniyor...</div>
        <div class="text-slate-500 dark:text-slate-400 text-sm">Lütfen bekleyin.</div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, Component } = React;

        class ErrorBoundary extends Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            static getDerivedStateFromError(error) { return { hasError: true, error }; }
            componentDidCatch(error, errorInfo) { console.error("Uygulama Hatası:", error, errorInfo); }
            render() {
                if (this.state.hasError) {
                    const loader = document.getElementById('loading-screen');
                    if (loader) loader.style.display = 'none';
                    return (
                        <div className="min-h-screen flex items-center justify-center bg-red-50 p-6 text-center">
                            <div>
                                <h1 className="text-2xl font-bold text-red-600 mb-2">Bir Hata Oluştu</h1>
                                <button onClick={() => window.location.reload()} className="mt-6 px-6 py-2 bg-red-600 text-white rounded-lg font-bold">Sayfayı Yenile</button>
                            </div>
                        </div>
                    );
                }
                return this.props.children; 
            }
        }

        const Icon = ({ name, className, size = 24 }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.setAttribute('class', className || '');
                    i.setAttribute('width', size);
                    i.setAttribute('height', size);
                    iconRef.current.innerHTML = '';
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons({ root: iconRef.current });
                }
            }, [name, className, size]);
            return <span ref={iconRef} style={{ display: 'inline-flex', verticalAlign: 'middle' }}></span>;
        };

        const varsayilanFiyatlar = {
            genel: { dolar_kuru: 34.00 },
            karton_ton: { 
                krome_210: 25000, krome_225: 25500, krome_230: 26000, krome_280: 27500, krome_350_400: 29000, 
                bristol_230: 950, bristol_300: 980, bristol_350: 1000  
            },
            ondule_m2: { 
                e_ts: 8.5, e_bs: 9.0, b_ts: 8.5, b_bs: 9.0, eb_tss: 12.0, eb_bss: 13.0, eb_mksss: 14.0, yok: 0
            },
            ekstra_saman: { tek_saman: 1.5, cift_saman: 3.0 },
            makine_70x100: { taban_fiyat: 5200, gecis_4_renk: 1.20, gecis_tek_renk: 0.30, kalip_tek_renk: 1300 },
            makine_100x140: { taban_fiyat: 10000, gecis_4_renk: 2.00, gecis_tek_renk: 0.50, kalip_tek_renk: 2500 },
            lak_kaplama: {
                yok: 0, dispersiyon_70x100: 1.5, dispersiyon_100x140: 2.0, mat_lak: 2.0, uv_lak: 2.5,
                parlak_selefon: 3.0, mat_selefon: 3.5, min_tutar_70x100: 2500, min_tutar_100x140: 3500
            },
            iscilik: { 
                tek_dikis: 0.50, cift_dikis: 0.80, yapistirma: 0.60, 
                sivama: 0.30, 
                kesim: 2.00 
            }
        };

        function KutuHesaplama() {
            const [ebatTabaka, setEbatTabaka] = useState({ en: 70, boy: 100 });
            const [adet, setAdet] = useState(1000);
            const [bicakSayisi, setBicakSayisi] = useState(2); 
            const [baskiTabaka, setBaskiTabaka] = useState(700); 
            const [siparisTipi, setSiparisTipi] = useState('yeni'); 
            const [nakliye, setNakliye] = useState(0);
            const [kalipUcreti, setKalipUcreti] = useState(2000); 
            
            const [kartonTip, setKartonTip] = useState('krome_230'); 
            const [onduleTip, setOnduleTip] = useState('e_ts'); 
            const [ekstraSamanSecimi, setEkstraSamanSecimi] = useState('yok'); 
            
            const [makineTipi, setMakineTipi] = useState('70x100'); 
            const [ekstraRenk, setEkstraRenk] = useState(0); 
            const [lakTipi, setLakTipi] = useState('yok');
            const [dikisTipi, setDikisTipi] = useState('tek_dikis');
            
            const [ayarlarAcik, setAyarlarAcik] = useState(false);
            const [fiyatlar, setFiyatlar] = useState(varsayilanFiyatlar);
            const [darkMode, setDarkMode] = useState(false);

            const [makineHata, setMakineHata] = useState(false);
            const [makineUyariMesaji, setMakineUyariMesaji] = useState('');

            const [sonuc, setSonuc] = useState({
                detayKarton: 0, detayOndule: 0, detayBaski: 0, detayLak: 0, detaySivama: 0, detayKesim: 0, detayYapistirma: 0,
                detayFire: 0, detayNakliye: 0, detayKalip: 0, toplamTutar: 0, birimFiyat: 0,
                kullanilanEn: 0, kullanilanBoy: 0, tabakaGram: 0, toplamTabaka: 0, 
                lakMinUygulandi: false, sivamaMinUygulandi: false
            });

            useEffect(() => {
                const loader = document.getElementById('loading-screen');
                if (loader) {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 500);
                }
            }, []);

            useEffect(() => {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                } else {
                    setDarkMode(false);
                    document.documentElement.classList.remove('dark');
                }
            }, []);

            const toggleDarkMode = () => {
                if (darkMode) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                    setDarkMode(false);
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                    setDarkMode(true);
                }
            };

            useEffect(() => {
                const uretimAdedi = Number(adet) || 0;
                const bicak = Number(bicakSayisi) || 1;
                const netTabaka = Math.ceil(uretimAdedi / bicak) + 200;
                setBaskiTabaka(netTabaka);
            }, [adet, bicakSayisi]);

            useEffect(() => {
                const kayitliFiyatlar = localStorage.getItem('kutu_fiyat_v16');
                if (kayitliFiyatlar) {
                    try { 
                        const par = JSON.parse(kayitliFiyatlar);
                        setFiyatlar({ ...varsayilanFiyatlar, ...par, 
                            karton_ton: {...varsayilanFiyatlar.karton_ton, ...(par.karton_ton || {})},
                            ondule_m2: {...varsayilanFiyatlar.ondule_m2, ...(par.ondule_m2 || {})},
                            ekstra_saman: {...varsayilanFiyatlar.ekstra_saman, ...(par.ekstra_saman || {})},
                            makine_70x100: {...varsayilanFiyatlar.makine_70x100, ...(par.makine_70x100 || {})},
                            makine_100x140: {...varsayilanFiyatlar.makine_100x140, ...(par.makine_100x140 || {})},
                            lak_kaplama: {...varsayilanFiyatlar.lak_kaplama, ...(par.lak_kaplama || {})},
                            iscilik: {...varsayilanFiyatlar.iscilik, ...(par.iscilik || {})}
                        }); 
                    } catch (e) { }
                }
                const kayitliGirdiler = localStorage.getItem('kutu_girdiler_v6');
                if (kayitliGirdiler) {
                    try {
                        const veri = JSON.parse(kayitliGirdiler);
                        if(veri.ebatTabaka) setEbatTabaka(veri.ebatTabaka);
                        if(veri.adet) setAdet(veri.adet);
                        if(veri.bicakSayisi) setBicakSayisi(veri.bicakSayisi);
                        if(veri.baskiTabaka) setBaskiTabaka(veri.baskiTabaka);
                        if(veri.kartonTip) setKartonTip(veri.kartonTip);
                        if(veri.onduleTip) setOnduleTip(veri.onduleTip);
                        if(veri.ekstraSamanSecimi) setEkstraSamanSecimi(veri.ekstraSamanSecimi);
                        if(veri.makineTipi) setMakineTipi(veri.makineTipi);
                        if(veri.ekstraRenk !== undefined) setEkstraRenk(veri.ekstraRenk);
                        if(veri.lakTipi) setLakTipi(veri.lakTipi);
                        if(veri.dikisTipi) setDikisTipi(veri.dikisTipi);
                        if(veri.siparisTipi) setSiparisTipi(veri.siparisTipi);
                        if(veri.nakliye !== undefined) setNakliye(veri.nakliye);
                        if(veri.kalipUcreti !== undefined) setKalipUcreti(veri.kalipUcreti);
                    } catch(e) { }
                }
            }, []);

            useEffect(() => {
                const veriler = { ebatTabaka, adet, bicakSayisi, baskiTabaka, kartonTip, onduleTip, ekstraSamanSecimi, makineTipi, ekstraRenk, lakTipi, dikisTipi, siparisTipi, nakliye, kalipUcreti };
                localStorage.setItem('kutu_girdiler_v6', JSON.stringify(veriler));
            }, [ebatTabaka, adet, bicakSayisi, baskiTabaka, kartonTip, onduleTip, ekstraSamanSecimi, makineTipi, ekstraRenk, lakTipi, dikisTipi, siparisTipi, nakliye, kalipUcreti]);

            useEffect(() => {
                const en = Number(ebatTabaka.en);
                const boy = Number(ebatTabaka.boy);

                if ((en > 72 || boy > 102) && makineTipi !== '100x140') {
                    setMakineTipi('100x140');
                }
                if (en === 72 && boy === 102 && makineTipi === '70x100') {
                    setMakineUyariMesaji('Baskı alanını kontrol ediniz makas dahil 72 x 102 olmalıdır');
                } else {
                    setMakineUyariMesaji('');
                }
            }, [ebatTabaka, makineTipi]);

            const handleMakineSecimi = (tip) => {
                const en = Number(ebatTabaka.en);
                const boy = Number(ebatTabaka.boy);
                if (tip === '70x100') {
                    if (en > 72 || boy > 102) {
                        setMakineHata(true);
                        setMakineTipi('100x140');
                        setTimeout(() => setMakineHata(false), 3000);
                        return;
                    }
                }
                setMakineTipi(tip);
            };

            const fiyatGuncelle = (kat, alt, val) => {
                const yeni = { ...fiyatlar };
                yeni[kat][alt] = Number(val);
                setFiyatlar(yeni);
            };
            const fiyatKaydet = () => {
                localStorage.setItem('kutu_fiyat_v16', JSON.stringify(fiyatlar));
                setAyarlarAcik(false);
                alert("Tüm ayarlar kaydedildi.");
            };
            const ayarlariYedekle = () => {
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(fiyatlar));
                const node = document.createElement('a');
                node.setAttribute("href", dataStr);
                node.setAttribute("download", "kutu_fiyat_full_yedek.json");
                document.body.appendChild(node); node.click(); node.remove();
            };
            const ayarlariYukle = (e) => {
                const reader = new FileReader();
                reader.readAsText(e.target.files[0], "UTF-8");
                reader.onload = (ev) => {
                    try {
                        const json = JSON.parse(ev.target.result);
                        setFiyatlar(json);
                        localStorage.setItem('kutu_fiyat_v16', JSON.stringify(json));
                        alert("Ayarlar yüklendi.");
                    } catch (err) { alert("Dosya hatalı."); }
                };
            };

            useEffect(() => {
                const tekli = ['e_ts', 'e_bs', 'b_ts', 'b_bs'];
                if (tekli.includes(onduleTip) && ekstraSamanSecimi === 'cift') setEkstraSamanSecimi('tek');
                if (onduleTip === 'yok') setEkstraSamanSecimi('yok');
            }, [onduleTip]);

            // HESAPLAMA MOTORU
            useEffect(() => {
                const tEn = Number(ebatTabaka.en) || 0;
                const tBoy = Number(ebatTabaka.boy) || 0;
                const uretimAdedi = Number(adet) || 1;
                const tabakaBicak = Number(bicakSayisi) || 1; 
                
                // Brüt Tabaka (Baskı & Lak için)
                const toplamTabakaSayisi = Number(baskiTabaka) || (Math.ceil(uretimAdedi / tabakaBicak) + 200);
                // Net Tabaka (Sıvama & Kesim için - Fire Hariç)
                const netTabakaSayisi = Math.ceil(uretimAdedi / tabakaBicak);

                // 1. KARTON (Net)
                let gramajDegeri = 0, tonFiyati = 0;
                const kur = fiyatlar.genel.dolar_kuru || 34;
                if (kartonTip.includes('krome')) {
                    const gr = kartonTip.split('_')[1];
                    gramajDegeri = Number(gr); 
                    if(kartonTip === 'krome_350' || kartonTip === 'krome_400') tonFiyati = fiyatlar.karton_ton.krome_350_400;
                    else tonFiyati = fiyatlar.karton_ton[kartonTip];
                } else {
                    const gr = kartonTip.split('_')[1];
                    gramajDegeri = Number(gr);
                    tonFiyati = fiyatlar.karton_ton[kartonTip] * kur;
                }
                const tabakaGramaj = (tEn * tBoy * gramajDegeri * 1.03) / 10000;
                const tabakaMaliyeti = (tabakaGramaj / 1000) * (tonFiyati / 1000);
                const birimKartonMaliyeti = tabakaMaliyeti / tabakaBicak;
                const toplamKartonTutar = birimKartonMaliyeti * uretimAdedi;

                // 2. ONDÜLE (Net)
                let onduleM2 = fiyatlar.ondule_m2[onduleTip] || 0;
                if (ekstraSamanSecimi === 'tek') onduleM2 += (fiyatlar.ekstra_saman.tek_saman || 0);
                if (ekstraSamanSecimi === 'cift') onduleM2 += (fiyatlar.ekstra_saman.cift_saman || 0);
                const tabakaM2Alani = (tEn * tBoy) / 10000;
                const tabakaOnduleMaliyeti = tabakaM2Alani * onduleM2;
                const birimOnduleMaliyeti = tabakaOnduleMaliyeti / tabakaBicak;
                const toplamOnduleTutar = birimOnduleMaliyeti * uretimAdedi;

                // 3. BASKI (Brüt)
                let baskiMaliyeti = 0;
                const mParams = makineTipi === '70x100' ? fiyatlar.makine_70x100 : fiyatlar.makine_100x140;
                const ekstraKRenkSayisi = Number(ekstraRenk) || 0;
                const ekstraKalipMaliyeti = ekstraKRenkSayisi * mParams.kalip_tek_renk;
                const tabanFiyatToplam = mParams.taban_fiyat + ekstraKalipMaliyeti;
                let fazlalikTutar = 0;
                if (toplamTabakaSayisi > 2000) {
                    const fazlaTabaka = toplamTabakaSayisi - 2000;
                    const birimGecisFiyati = mParams.gecis_4_renk + (ekstraKRenkSayisi * mParams.gecis_tek_renk);
                    fazlalikTutar = fazlaTabaka * birimGecisFiyati;
                }
                baskiMaliyeti = tabanFiyatToplam + fazlalikTutar;

                // 4. LAK (Brüt)
                let lakHamTutar = 0;
                let lakMinUygulandi = false;
                if (lakTipi !== 'yok') {
                    let lakM2Fiyat = 0;
                    let minLakTutari = 0;
                    if (makineTipi === '70x100') {
                        minLakTutari = fiyatlar.lak_kaplama.min_tutar_70x100 || 2500;
                        if (lakTipi === 'dispersiyon') lakM2Fiyat = fiyatlar.lak_kaplama.dispersiyon_70x100 || 0;
                        else lakM2Fiyat = fiyatlar.lak_kaplama[lakTipi] || 0;
                    } else {
                        minLakTutari = fiyatlar.lak_kaplama.min_tutar_100x140 || 3500;
                        if (lakTipi === 'dispersiyon') lakM2Fiyat = fiyatlar.lak_kaplama.dispersiyon_100x140 || 0;
                        else lakM2Fiyat = fiyatlar.lak_kaplama[lakTipi] || 0;
                    }
                    lakHamTutar = tabakaM2Alani * lakM2Fiyat * toplamTabakaSayisi;
                    if (lakHamTutar < minLakTutari) {
                        lakHamTutar = minLakTutari;
                        lakMinUygulandi = true;
                    }
                }

                // 5. İŞÇİLİK
                
                // Sıvama (NET Üzerinden)
                let sivamaTutar = 0;
                let sivamaMinUygulandi = false;
                if (onduleTip !== 'yok') {
                    sivamaTutar = tabakaM2Alani * fiyatlar.iscilik.sivama * netTabakaSayisi;
                    if (sivamaTutar < 3500) {
                        sivamaTutar = 3500;
                        sivamaMinUygulandi = true;
                    }
                }

                // KESİM (NET Üzerinden)
                const kesimTutar = fiyatlar.iscilik.kesim * netTabakaSayisi;

                let dikisBirim = 0;
                if (dikisTipi !== 'yok') {
                    if (dikisTipi === 'tek_dikis') dikisBirim = fiyatlar.iscilik.tek_dikis;
                    if (dikisTipi === 'cift_dikis') dikisBirim = fiyatlar.iscilik.cift_dikis;
                    if (dikisTipi === 'yapistirma') dikisBirim = fiyatlar.iscilik.yapistirma;
                }
                const yapistirmaTutar = uretimAdedi * dikisBirim;

                // 6. EKSTRALAR
                const altToplam = toplamKartonTutar + toplamOnduleTutar + baskiMaliyeti;
                const birimUrunMaliyeti = uretimAdedi > 0 ? (altToplam / uretimAdedi) : 0;
                const fireTutari = birimUrunMaliyeti * 100;
                const kalipTutari = siparisTipi === 'yeni' ? (Number(kalipUcreti) || 0) : 0;
                const nakliyeTutari = Number(nakliye) || 0;

                const genelToplam = altToplam + lakHamTutar + sivamaTutar + kesimTutar + yapistirmaTutar + fireTutari + kalipTutari + nakliyeTutari;

                setSonuc({
                    detayKarton: toplamKartonTutar, detayOndule: toplamOnduleTutar, detayBaski: baskiMaliyeti,
                    detayLak: lakHamTutar, detaySivama: sivamaTutar, detayKesim: kesimTutar, detayYapistirma: yapistirmaTutar,
                    detayFire: fireTutari, detayKalip: kalipTutari, detayNakliye: nakliyeTutari,
                    toplamTutar: genelToplam, birimFiyat: genelToplam / uretimAdedi,
                    kullanilanEn: tEn, kullanilanBoy: tBoy, tabakaGram: tabakaGramaj, toplamTabaka: toplamTabakaSayisi,
                    lakMinUygulandi, sivamaMinUygulandi
                });

            }, [ebatTabaka, adet, bicakSayisi, baskiTabaka, kartonTip, onduleTip, ekstraSamanSecimi, makineTipi, ekstraRenk, lakTipi, dikisTipi, siparisTipi, nakliye, kalipUcreti, fiyatlar]);

            const paraFormat = (v) => new Intl.NumberFormat('tr-TR', { style: 'currency', currency: 'TRY' }).format(v || 0);
            const sayiFormat = (v) => new Intl.NumberFormat('tr-TR').format(v || 0);
            const birim = (toplam) => (toplam || 0) / (Number(adet) || 1);

            return (
                <div className="min-h-screen p-2 md:p-6 max-w-7xl mx-auto pb-20">
                    <div className="flex justify-between items-center mb-6 bg-white dark:bg-darkcard p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 transition-colors">
                        <div>
                            <h1 className="text-xl md:text-2xl font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2">
                                <Icon name="calculator" className="w-6 h-6 text-blue-600 dark:text-blue-400" /> Ofset Kutu Maliyet
                            </h1>
                            <p className="text-[10px] md:text-xs text-slate-500 dark:text-slate-400 mt-1">Dolar Kur: {fiyatlar.genel.dolar_kuru}</p>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={toggleDarkMode} className="p-2 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors">
                                {darkMode ? <Icon name="sun" className="w-5 h-5" /> : <Icon name="moon" className="w-5 h-5" />}
                            </button>
                            <button onClick={() => setAyarlarAcik(true)} className="flex items-center gap-2 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-200 px-3 py-2 rounded-lg border dark:border-slate-600 font-medium text-sm transition-colors">
                                <Icon name="settings" className="w-4 h-4" /> Ayarlar
                            </button>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                        <div className="lg:col-span-5 space-y-6">
                            
                            <div className="bg-white dark:bg-darkcard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 transition-colors">
                                <h2 className="font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2">
                                    <div className="bg-blue-100 dark:bg-blue-900 p-1.5 rounded text-blue-600 dark:text-blue-300"><Icon name="printer" className="w-4 h-4" /></div>
                                    Sipariş & Ebat
                                </h2>
                                
                                <div className="mb-4 bg-slate-50 dark:bg-darkinput p-2 rounded flex gap-2">
                                    <button onClick={()=>setSiparisTipi('yeni')} className={`flex-1 py-2 text-xs font-bold rounded transition ${siparisTipi === 'yeni' ? 'bg-green-600 text-white shadow' : 'text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-700'}`}>YENİ SİPARİŞ</button>
                                    <button onClick={()=>setSiparisTipi('rpt')} className={`flex-1 py-2 text-xs font-bold rounded transition ${siparisTipi === 'rpt' ? 'bg-blue-600 text-white shadow' : 'text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-700'}`}>RPT SİPARİŞ</button>
                                </div>

                                <div className={`mb-4 p-2 rounded border transition-colors ${makineHata ? 'border-red-500 bg-red-50 dark:bg-red-900/10 animate-shake' : 'border-transparent'}`}>
                                    <label className={`block text-xs font-bold mb-1 ${makineHata ? 'text-red-600' : 'text-slate-500 dark:text-slate-400'}`}>Baskı Makinesi</label>
                                    <div className="flex gap-2">
                                        <button onClick={()=>handleMakineSecimi('70x100')} className={`flex-1 py-2 rounded border text-sm font-bold transition ${makineTipi === '70x100' ? 'bg-blue-600 text-white border-blue-600' : 'bg-slate-50 dark:bg-darkinput text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-600'}`}>70 x 100</button>
                                        <button onClick={()=>handleMakineSecimi('100x140')} className={`flex-1 py-2 rounded border text-sm font-bold transition ${makineTipi === '100x140' ? 'bg-blue-600 text-white border-blue-600' : 'bg-slate-50 dark:bg-darkinput text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-600'}`}>100 x 140</button>
                                    </div>
                                    {makineHata && <div className="text-xs text-red-600 font-bold mt-1 text-center">Bu ebat küçük makineye uygun değil!</div>}
                                    {makineUyariMesaji && !makineHata && <div className="text-xs text-orange-600 font-bold mt-1 text-center bg-orange-50 p-1 rounded border border-orange-200">{makineUyariMesaji}</div>}
                                </div>

                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400">Tabaka En</label><input type="number" inputMode="decimal" value={ebatTabaka.en} onChange={e=>setEbatTabaka({...ebatTabaka, en: e.target.value})} className="w-full p-2 border dark:border-slate-600 rounded font-bold text-lg text-slate-700 dark:text-slate-200 bg-white dark:bg-darkinput" /></div>
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400">Tabaka Boy</label><input type="number" inputMode="decimal" value={ebatTabaka.boy} onChange={e=>setEbatTabaka({...ebatTabaka, boy: e.target.value})} className="w-full p-2 border dark:border-slate-600 rounded font-bold text-lg text-slate-700 dark:text-slate-200 bg-white dark:bg-darkinput" /></div>
                                </div>
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Bıçak Sayısı</label><input type="number" inputMode="decimal" value={bicakSayisi} onChange={e=>setBicakSayisi(e.target.value)} className="w-full p-2 pl-3 border dark:border-slate-600 rounded font-bold bg-white dark:bg-darkinput text-slate-700 dark:text-slate-200" /></div>
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Sipariş Adedi</label><input type="number" inputMode="decimal" value={adet} onChange={e=>setAdet(e.target.value)} className="w-full p-2 border border-blue-300 dark:border-blue-700 rounded font-bold text-blue-700 dark:text-blue-400 bg-white dark:bg-darkinput" /></div>
                                </div>
                                <div className={`p-3 rounded border mb-4 ${Number(baskiTabaka) < 1000 ? 'bg-red-50 dark:bg-red-900/20 border-red-500 dark:border-red-700' : 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800'}`}>
                                    <label className={`text-xs font-bold block mb-1 ${Number(baskiTabaka) < 1000 ? 'text-red-800 dark:text-red-300' : 'text-blue-800 dark:text-blue-300'}`}>Baskı Tabaka Adedi (+ 200 Fire)</label>
                                    <input type="number" inputMode="decimal" value={baskiTabaka} onChange={e=>setBaskiTabaka(e.target.value)} className={`w-full p-2 border rounded font-bold text-xl ${Number(baskiTabaka) < 1000 ? 'text-red-600 dark:text-red-400 border-red-300 dark:border-red-700 bg-white dark:bg-darkinput' : 'text-blue-800 dark:text-blue-300 bg-white dark:bg-darkinput border-transparent'}`} />
                                    {Number(baskiTabaka) < 1000 ? <div className="text-[10px] text-red-600 dark:text-red-400 mt-1 font-bold flex items-center gap-1"><Icon name="alert-circle" className="w-3 h-3" />⚠️ Minimum 1000 tabaka olmalıdır (Fire dahil)</div> : <div className="text-[10px] text-blue-600 dark:text-blue-400 mt-1">Otomatik: (Adet / Bıçak) + 200 Fire</div>}
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Nakliye Tutarı (TL)</label>
                                    <input type="number" inputMode="decimal" value={nakliye} onChange={e=>setNakliye(e.target.value)} className="w-full p-2 border dark:border-slate-600 rounded font-bold text-slate-700 dark:text-slate-200 bg-white dark:bg-darkinput" placeholder="0" />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Bıçak/Kalıp Tutarı (TL)</label>
                                    <input type="number" inputMode="decimal" value={kalipUcreti} onChange={e=>setKalipUcreti(e.target.value)} className={`w-full p-2 border dark:border-slate-600 rounded font-bold ${siparisTipi === 'rpt' ? 'bg-slate-100 dark:bg-slate-800 text-slate-400 dark:text-slate-500' : 'bg-white dark:bg-darkinput text-slate-700 dark:text-slate-200'}`} placeholder="0" disabled={siparisTipi === 'rpt'} />
                                    {siparisTipi === 'rpt' && <div className="text-[10px] text-orange-500 mt-1">* RPT Siparişte kalıp ücreti eklenmez.</div>}
                                </div>
                            </div>

                            {/* MALZEME */}
                            <div className="bg-white dark:bg-darkcard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 transition-colors">
                                <h2 className="font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2">
                                    <div className="bg-orange-100 dark:bg-orange-900 p-1.5 rounded text-orange-600 dark:text-orange-300"><Icon name="layers" className="w-4 h-4" /></div>
                                    Kağıt & Ondüle
                                </h2>
                                <div className="space-y-4">
                                    <select value={kartonTip} onChange={e=>setKartonTip(e.target.value)} className="w-full p-3 border dark:border-slate-600 rounded bg-slate-50 dark:bg-darkinput text-sm text-slate-700 dark:text-slate-200">
                                        <optgroup label="Krome (TL)"><option value="krome_210">210 gr</option><option value="krome_225">225 gr</option><option value="krome_230">230 gr</option><option value="krome_280">280 gr</option><option value="krome_350">350 gr</option><option value="krome_400">400 gr</option></optgroup>
                                        <optgroup label="Bristol ($)"><option value="bristol_230">230 gr</option><option value="bristol_300">300 gr</option><option value="bristol_350">350 gr</option></optgroup>
                                    </select>
                                    <div className="bg-slate-50 dark:bg-slate-800/50 p-3 rounded border dark:border-slate-700">
                                        <select value={onduleTip} onChange={e=>setOnduleTip(e.target.value)} className="w-full p-3 border dark:border-slate-600 rounded bg-white dark:bg-darkinput mb-2 text-sm text-slate-700 dark:text-slate-200">
                                            <option value="yok">Yok (Sadece Karton)</option><option value="e_ts">E TS</option><option value="e_bs">E BS</option><option value="b_ts">B TS</option><option value="b_bs">B BS</option><option value="eb_tss">EB TSSS</option><option value="eb_bss">EB BSSS</option><option value="eb_mksss">EB MKSSS</option>
                                        </select>
                                        {onduleTip !== 'yok' && (
                                            <div className="flex gap-4 mt-2">
                                                <label className="flex items-center gap-1 cursor-pointer text-slate-600 dark:text-slate-300"><input type="radio" checked={ekstraSamanSecimi === 'yok'} onChange={()=>setEkstraSamanSecimi('yok')} className="w-4 h-4" /><span className="text-xs">Std</span></label>
                                                <label className="flex items-center gap-1 cursor-pointer text-slate-600 dark:text-slate-300"><input type="radio" checked={ekstraSamanSecimi === 'tek'} onChange={()=>setEkstraSamanSecimi('tek')} className="w-4 h-4" /><span className="text-xs">Tek Saman</span></label>
                                                {['eb_tss', 'eb_bss', 'eb_mksss'].includes(onduleTip) && <label className="flex items-center gap-1 cursor-pointer text-slate-600 dark:text-slate-300"><input type="radio" checked={ekstraSamanSecimi === 'cift'} onChange={()=>setEkstraSamanSecimi('cift')} className="w-4 h-4" /><span className="text-xs">Çift Saman</span></label>}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white dark:bg-darkcard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 transition-colors">
                                <h2 className="font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2">
                                    <div className="bg-purple-100 dark:bg-purple-900 p-1.5 rounded text-purple-600 dark:text-purple-300"><Icon name="palette" className="w-4 h-4" /></div>
                                    Baskı & Lak
                                </h2>
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400">Standart Renk</label><div className="p-2 bg-slate-100 dark:bg-darkinput rounded text-center text-sm font-bold text-slate-600 dark:text-slate-300">4 Renk CMYK</div></div>
                                    <div><label className="text-xs font-bold text-slate-500 dark:text-slate-400">Ekstra Renk (+)</label><input type="number" min="0" value={ekstraRenk} onChange={e=>setEkstraRenk(e.target.value)} className="w-full p-2 border dark:border-slate-600 rounded text-center bg-white dark:bg-darkinput text-slate-700 dark:text-slate-200" placeholder="0" /></div>
                                </div>
                                <div className="space-y-3">
                                    <div>
                                        <label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Yüzey Kaplama (Lak/Selefon)</label>
                                        <select value={lakTipi} onChange={e=>setLakTipi(e.target.value)} className="w-full p-2 border dark:border-slate-600 rounded text-sm bg-white dark:bg-darkinput text-slate-700 dark:text-slate-200">
                                            <option value="yok">Yok</option><option value="dispersiyon">Dispersiyon Lak</option><option value="mat_lak">Mat Lak</option><option value="uv_lak">UV Lak</option><option value="parlak_selefon">Parlak Selefon</option><option value="mat_selefon">Mat Selefon</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1">Birleştirme</label>
                                        <select value={dikisTipi} onChange={e=>setDikisTipi(e.target.value)} className="w-full p-2 border dark:border-slate-600 rounded text-sm bg-white dark:bg-darkinput text-slate-700 dark:text-slate-200">
                                            <option value="yok">Yok</option>
                                            <option value="tek_dikis">Tek Dikiş</option>
                                            <option value="cift_dikis">Çift Dikiş</option>
                                            <option value="yapistirma">Yapıştırma</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* SONUÇLAR */}
                        <div className="lg:col-span-7 space-y-6">
                            <div className="bg-slate-800 dark:bg-slate-900 text-white rounded-2xl p-6 shadow-lg relative overflow-hidden transition-colors">
                                <div className="grid grid-cols-2 gap-8 relative z-10">
                                    <div>
                                        <div className="text-slate-400 text-xs font-bold uppercase mb-1">Toplam Maliyet</div>
                                        <div className="text-3xl font-bold">{paraFormat(sonuc.toplamTutar)}</div>
                                        <div className="text-xs text-slate-400 mt-2">{sayiFormat(adet)} adet için</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-green-400 text-xs font-bold uppercase mb-1">Birim Fiyat</div>
                                        <div className="text-4xl font-bold">{paraFormat(sonuc.birimFiyat)}</div>
                                        <div className="text-xs text-slate-400 mt-2">KDV Hariç</div>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white dark:bg-darkcard rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden overflow-x-auto transition-colors">
                                <table className="w-full text-sm text-left text-slate-700 dark:text-slate-300">
                                    <thead className="text-xs text-slate-500 dark:text-slate-400 uppercase bg-slate-50 dark:bg-slate-800/50 border-b dark:border-slate-700"><tr><th className="px-4 py-3">Gider Kalemi</th><th className="px-4 py-3 text-right">Birim (Ort)</th><th className="px-4 py-3 text-right">Toplam</th></tr></thead>
                                    <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
                                        <tr><td className="px-4 py-3 font-medium">Karton</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayKarton))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayKarton)}</td></tr>
                                        {sonuc.detayOndule > 0 && <tr><td className="px-4 py-3 font-medium">Ondüle</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayOndule))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayOndule)}</td></tr>}
                                        <tr><td className="px-4 py-3 font-medium">Baskı ({makineTipi})<div className="text-[10px] text-slate-400">{sayiFormat(sonuc.toplamTabaka)} Tabaka</div></td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayBaski))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayBaski)}</td></tr>
                                        {sonuc.detayLak > 0 && <tr><td className="px-4 py-3 font-medium">Yüzey Kaplama {sonuc.lakMinUygulandi && <span className="text-red-500 text-[10px]">(Min)</span>}</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayLak))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayLak)}</td></tr>}
                                        {sonuc.detaySivama > 0 && <tr><td className="px-4 py-3 font-medium">Sıvama {sonuc.sivamaMinUygulandi && <span className="text-red-500 text-[10px]">(Min)</span>}</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detaySivama))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detaySivama)}</td></tr>}
                                        <tr><td className="px-4 py-3 font-medium">Kesim</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayKesim))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayKesim)}</td></tr>
                                        <tr><td className="px-4 py-3 font-medium">Birleştirme/Dikiş</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayYapistirma))}</td><td className="px-4 py-3 text-right font-bold font-mono">{paraFormat(sonuc.detayYapistirma)}</td></tr>
                                        <tr><td className="px-4 py-3 font-medium text-red-600 dark:text-red-400">Fire Bedeli (100 Adet)</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayFire))}</td><td className="px-4 py-3 text-right font-bold font-mono text-red-600 dark:text-red-400">{paraFormat(sonuc.detayFire)}</td></tr>
                                        <tr><td className="px-4 py-3 font-medium text-orange-600 dark:text-orange-400">Nakliye</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayNakliye))}</td><td className="px-4 py-3 text-right font-bold font-mono text-orange-600 dark:text-orange-400">{paraFormat(sonuc.detayNakliye)}</td></tr>
                                        {sonuc.detayKalip > 0 && <tr><td className="px-4 py-3 font-medium text-blue-600 dark:text-blue-400">Bıçak/Kalıp (Yeni)</td><td className="px-4 py-3 text-right font-mono text-slate-600 dark:text-slate-400">{paraFormat(birim(sonuc.detayKalip))}</td><td className="px-4 py-3 text-right font-bold font-mono text-blue-600 dark:text-blue-400">{paraFormat(sonuc.detayKalip)}</td></tr>}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    {ayarlarAcik && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm" onClick={()=>setAyarlarAcik(false)}>
                            <div className="bg-white dark:bg-darkcard rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col transition-colors" onClick={e=>e.stopPropagation()}>
                                <div className="p-4 border-b dark:border-slate-700 flex justify-between items-center"><h2 className="font-bold text-slate-800 dark:text-slate-200">Ayarlar</h2><button onClick={()=>setAyarlarAcik(false)} className="text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"><Icon name="x" /></button></div>
                                <div className="p-6 overflow-y-auto space-y-6">
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="bg-green-50 dark:bg-green-900/20 p-3 rounded border border-green-200 dark:border-green-800"><label className="text-xs font-bold text-green-800 dark:text-green-300">DOLAR KURU</label><input type="number" step="0.01" value={fiyatlar.genel.dolar_kuru} onChange={e=>fiyatGuncelle('genel','dolar_kuru',e.target.value)} className="w-full p-2 border rounded mt-1 font-bold dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                        {/* Kalıp ücreti buradan kaldırıldı */}
                                    </div>

                                    <div>
                                        <h3 className="font-bold text-blue-600 dark:text-blue-400 text-sm mb-2 uppercase border-b dark:border-slate-700 pb-1"><Icon name="package" className="w-4 h-4 inline mr-1" /> Krome Karton (TL/TON)</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-3 gap-4 mb-4">
                                            {Object.keys(fiyatlar.karton_ton).filter(k=>k.includes('krome')).map(k=>(
                                                <div key={k}><label className="text-xs block mb-1 font-bold uppercase text-slate-600 dark:text-slate-400">{k.replace('krome_','')}</label><input type="number" value={fiyatlar.karton_ton[k]} onChange={e=>fiyatGuncelle('karton_ton',k,e.target.value)} className="w-full p-2 border rounded font-mono dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            ))}
                                        </div>
                                        <h3 className="font-bold text-green-600 dark:text-green-400 text-sm mb-2 uppercase border-b dark:border-slate-700 pb-1"><Icon name="package" className="w-4 h-4 inline mr-1" /> Bristol Karton ($/TON)</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                                            {Object.keys(fiyatlar.karton_ton).filter(k=>k.includes('bristol')).map(k=>(
                                                <div key={k}><label className="text-xs block mb-1 font-bold uppercase text-slate-600 dark:text-slate-400">{k.replace('bristol_','')}</label><input type="number" value={fiyatlar.karton_ton[k]} onChange={e=>fiyatGuncelle('karton_ton',k,e.target.value)} className="w-full p-2 border border-green-200 bg-green-50 rounded font-mono dark:bg-green-900/20 dark:border-green-800 dark:text-green-300" /></div>
                                            ))}
                                        </div>
                                    </div>

                                    <div>
                                        <h3 className="font-bold text-orange-600 dark:text-orange-400 text-sm mb-2 uppercase border-b dark:border-slate-700 pb-1"><Icon name="layers" className="w-4 h-4 inline mr-1" /> Ondüle m² Fiyatları (TL)</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                            {Object.keys(fiyatlar.ondule_m2).filter(k=>k!=='yok').map(k=>(
                                                <div key={k}><label className="text-xs block mb-1 font-bold uppercase text-slate-600 dark:text-slate-400">{k.replace('_',' ')}</label><input type="number" step="0.1" value={fiyatlar.ondule_m2[k]} onChange={e=>fiyatGuncelle('ondule_m2',k,e.target.value)} className="w-full p-2 border rounded font-mono dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            ))}
                                        </div>
                                        <div className="bg-orange-50 dark:bg-orange-900/20 p-2 rounded border border-orange-200 dark:border-orange-800 grid grid-cols-2 gap-4">
                                            <div><label className="text-xs block mb-1 font-bold text-slate-700 dark:text-slate-300">Tek Saman Farkı</label><input type="number" step="0.1" value={fiyatlar.ekstra_saman.tek_saman} onChange={e=>fiyatGuncelle('ekstra_saman','tek_saman',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            <div><label className="text-xs block mb-1 font-bold text-slate-700 dark:text-slate-300">Çift Saman Farkı</label><input type="number" step="0.1" value={fiyatlar.ekstra_saman.cift_saman} onChange={e=>fiyatGuncelle('ekstra_saman','cift_saman',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                        </div>
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <h3 className="font-bold text-slate-700 dark:text-slate-200 text-sm mb-2 border-b dark:border-slate-700 pb-1">70x100 Makine</h3>
                                            <div className="space-y-2">
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Taban (2000'e kadar)</label><input type="number" value={fiyatlar.makine_70x100.taban_fiyat} onChange={e=>fiyatGuncelle('makine_70x100','taban_fiyat',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">2000+ Geçiş (4 Renk)</label><input type="number" step="0.01" value={fiyatlar.makine_70x100.gecis_4_renk} onChange={e=>fiyatGuncelle('makine_70x100','gecis_4_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Ekstra Renk Kalıp</label><input type="number" value={fiyatlar.makine_70x100.kalip_tek_renk} onChange={e=>fiyatGuncelle('makine_70x100','kalip_tek_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Ekstra Renk Geçiş</label><input type="number" step="0.01" value={fiyatlar.makine_70x100.gecis_tek_renk} onChange={e=>fiyatGuncelle('makine_70x100','gecis_tek_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            </div>
                                        </div>
                                        <div>
                                            <h3 className="font-bold text-slate-700 dark:text-slate-200 text-sm mb-2 border-b dark:border-slate-700 pb-1">100x140 Makine</h3>
                                            <div className="space-y-2">
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Taban (2000'e kadar)</label><input type="number" value={fiyatlar.makine_100x140.taban_fiyat} onChange={e=>fiyatGuncelle('makine_100x140','taban_fiyat',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">2000+ Geçiş (4 Renk)</label><input type="number" step="0.01" value={fiyatlar.makine_100x140.gecis_4_renk} onChange={e=>fiyatGuncelle('makine_100x140','gecis_4_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Ekstra Renk Kalıp</label><input type="number" value={fiyatlar.makine_100x140.kalip_tek_renk} onChange={e=>fiyatGuncelle('makine_100x140','kalip_tek_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                                <div><label className="text-xs block text-slate-600 dark:text-slate-400">Ekstra Renk Geçiş</label><input type="number" step="0.01" value={fiyatlar.makine_100x140.gecis_tek_renk} onChange={e=>fiyatGuncelle('makine_100x140','gecis_tek_renk',e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <h3 className="font-bold text-purple-600 dark:text-purple-400 text-sm mb-2 uppercase border-b dark:border-slate-700 pb-1"><Icon name="hammer" className="w-4 h-4 inline mr-1" /> Lak & İşçilikler (Makineye Özel)</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                            <div className="bg-blue-50 dark:bg-blue-900/20 p-2 rounded border border-blue-200 dark:border-blue-800 col-span-2">
                                                <label className="text-xs font-bold block mb-1 text-blue-800 dark:text-blue-300">Dispersiyon Lak (70x100)</label>
                                                <input type="number" step="0.1" value={fiyatlar.lak_kaplama.dispersiyon_70x100} onChange={e=>fiyatGuncelle('lak_kaplama','dispersiyon_70x100',e.target.value)} className="w-full p-2 border rounded bg-white dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" />
                                            </div>
                                            <div className="bg-purple-50 dark:bg-purple-900/20 p-2 rounded border border-purple-200 dark:border-purple-800 col-span-2">
                                                <label className="text-xs font-bold block mb-1 text-purple-800 dark:text-purple-300">Dispersiyon Lak (100x140)</label>
                                                <input type="number" step="0.1" value={fiyatlar.lak_kaplama.dispersiyon_100x140} onChange={e=>fiyatGuncelle('lak_kaplama','dispersiyon_100x140',e.target.value)} className="w-full p-2 border rounded bg-white dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" />
                                            </div>

                                            <div className="bg-blue-50 dark:bg-blue-900/20 p-2 rounded border border-blue-200 dark:border-blue-800 col-span-2">
                                                <label className="text-xs font-bold block mb-1 text-blue-800 dark:text-blue-300">Min Lak Bedeli (70x100)</label>
                                                <input type="number" value={fiyatlar.lak_kaplama.min_tutar_70x100} onChange={e=>fiyatGuncelle('lak_kaplama','min_tutar_70x100',e.target.value)} className="w-full p-2 border rounded bg-white dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" />
                                            </div>
                                            <div className="bg-purple-50 dark:bg-purple-900/20 p-2 rounded border border-purple-200 dark:border-purple-800 col-span-2">
                                                <label className="text-xs font-bold block mb-1 text-purple-800 dark:text-purple-300">Min Lak Bedeli (100x140)</label>
                                                <input type="number" value={fiyatlar.lak_kaplama.min_tutar_100x140} onChange={e=>fiyatGuncelle('lak_kaplama','min_tutar_100x140',e.target.value)} className="w-full p-2 border rounded bg-white dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" />
                                            </div>

                                            {Object.keys(fiyatlar.lak_kaplama).filter(k=>!k.includes('dispersiyon') && !k.includes('min_tutar') && k!=='yok').map(k=>(
                                                <div key={k}><label className="text-xs block mb-1 capitalize text-slate-600 dark:text-slate-400">{k.replace('_',' ')} (m²)</label><input type="number" step="0.1" value={fiyatlar.lak_kaplama[k]} onChange={e=>fiyatGuncelle('lak_kaplama',k,e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            ))}
                                            
                                            {Object.keys(fiyatlar.iscilik).filter(k=>k!=='selefon').map(k=>(
                                                <div key={k}><label className="text-xs block mb-1 capitalize text-slate-600 dark:text-slate-400">{k.replace('_',' ')} (Ad/Tb)</label><input type="number" step="0.01" value={fiyatlar.iscilik[k]} onChange={e=>fiyatGuncelle('iscilik',k,e.target.value)} className="w-full p-2 border rounded dark:bg-darkinput dark:border-slate-600 dark:text-slate-200" /></div>
                                            ))}
                                        </div>
                                    </div>

                                </div>
                                <div className="p-4 border-t dark:border-slate-700 flex justify-between">
                                    <div className="flex gap-2">
                                        <button onClick={ayarlariYedekle} className="px-3 py-2 border dark:border-slate-600 rounded text-xs text-slate-600 dark:text-slate-300"><Icon name="download" className="w-4 h-4 inline mr-1" /> Yedekle</button>
                                        <label className="px-3 py-2 border dark:border-slate-600 rounded text-xs cursor-pointer text-slate-600 dark:text-slate-300"><Icon name="upload" className="w-4 h-4 inline mr-1" /> Yükle<input type="file" accept=".json" onChange={ayarlariYukle} className="hidden" /></label>
                                    </div>
                                    <button onClick={fiyatKaydet} className="px-4 py-2 bg-blue-600 text-white rounded font-bold hover:bg-blue-700 transition-colors">Kaydet</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<KutuHesaplama />);
    </script>
</body>
</html>
